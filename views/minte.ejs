
<%-include("./h2.ejs")%>


     









              
          
                <!-- End of Topbar -->

                <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  <style>
    .card-img-top {
  height: 400px;
}

  </style>

 






<div class="container">
  <div class="row">
    <div class="col-md-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Lighting</h5>
          <p class="card-text">Click here to view lighting status and control.</p>
          <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#lightingModal">View Lighting</button>
        </div>
      </div>
    </div>
    <div class="col-md-4 pb-3">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Water</h5>
          <p class="card-text">Click here to view water usage and control.</p>
          <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#waterModal">View Water</button>
        </div>
      </div>
    </div>
    <div class="col-md-4 pb3">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Smart Curtains</h5>
          <p class="card-text">Click here to view curtains status and control.</p>
          <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#curtainsModal">View Curtains</button>
        </div>
      </div>
    </div>
    <div class="col-md-4 pb-3">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">Smart Devices</h5>
          <p class="card-text">Click here to view all smart devices and their status.</p>
          <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#smart-devicesModal">View Devices</button>
        </div>
      </div>
    </div>
  </div>
</div>



  
  <!-- Modal -->
  <div class="modal fade" id="waterModal" tabindex="-1" aria-labelledby="lightingModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="lightingModalLabel">Water Monitoring Panel</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            
            
         <table class="table">
  <thead>
    <tr>
      <th scope="col">Tap</th>
      <th scope="col">Status</th>
      <th scope="col">Control</th>
    </tr>
  </thead>
  <tbody>
    <% for (var i = 0; i < water.length; i++) { %>
      <tr>
        <th scope="row"><%= water[i].name %></th>
        <% if (water[i].status === 'on') { %>
          <td><span class="badge bg-success"><%= water[i].status %></span></td>
          <td><button id="<%=water[i]._id%> "type="button" class="btn btn-secondary">Turn Off</button></td>
        <% } else { %>
          <td><span class="badge bg-danger"><%= water[i].status %></span></td>
          <td><button id="<%=water[i]._id%>" type="button" class="btn btn-secondary">Turn On</button></td>
        <% } %>
      </tr>
    <% } %>
  </tbody>
</table>

          
          
          
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger">Turn All Off</button>
          <button type="button" class="btn btn-success">Turn All On</button>
        </div>
      </div>
    </div>
  </div>
  

  
  <!-- Modal -->
  <div class="modal fade" id="lightingModal" tabindex="-1" aria-labelledby="lightingModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="lightingModalLabel">Lighting Monitoring Panel</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <table class="table">
            <thead>
              <tr>
                <th scope="col">Light</th>
                <th scope="col">Status</th>
                <th scope="col">Control</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                  
                  
                  
                  <% for (var i = 0; i < light.length; i++) { %>
      <tr>
        <th scope="row"><%= light[i].name %></th>
        <% if (light[i].status === 'on') { %>
          <td><span class="badge bg-success"><%= light[i].status %></span></td>
          <td><button type="button" id="<%=light[i]._id%> " class="btn btn-secondary">Turn Off</button></td>
        <% } else { %>
          <td><span class="badge bg-danger"><%= light[i].status %></span></td>
          <td><button type="button" id="<%=light[i]._id%> " class="btn btn-secondary">Turn On</button></td>
        <% } %>
      </tr>
    <% } %>
              
            </tbody>
          </table>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger">Turn All Off</button>
          <button type="button" class="btn btn-success">Turn All On</button>
        </div>
      </div>
    </div>
  </div>
  

    
  <!-- Modal -->
  <div class="modal fade" id="curtainsModal" tabindex="-1" aria-labelledby="lightingModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="lightingModalLabel">Curtains Monitoring Panel</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <table class="table">
            <thead>
              <tr>
                <th scope="col">Curtain</th>
                <th scope="col">Status</th>
                <th scope="col">Control</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                  
                  
                  
                   <% for (var i = 0; i < curtain.length; i++) { %>
      <tr>
        <th scope="row"><%= curtain[i].name %></th>
        <% if (curtain[i].status === 'on') { %>
          <td><span class="badge bg-success"><%= curtain[i].status %></span></td>
          <td><button type="button" id="<%=curtain[i]._id%> " class="btn btn-secondary">Turn Off</button></td>
        <% } else { %>
          <td><span class="badge bg-danger"><%= curtain[i].status %></span></td>
          <td><button id="<%=curtain[i]._id%> " type="button" class="btn btn-secondary">Turn On</button></td>
        <% } %>
      </tr>
    <% } %> 
                
              </tr>
              
              
              
              
              
              
            </tbody>
            
            
            
            
          </table>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger">Turn All Off</button>
          <button type="button" class="btn btn-success">Turn All On</button>
        </div>
      </div>
    </div>
  </div>
  



    
  <!-- Modal -->
  <div class="modal fade" id="smart-devicesModal" tabindex="-1" aria-labelledby="lightingModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="lightingModalLabel">Smart Device Monitoring Panel</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <table class="table">
            <thead>
              <tr>
                  
                  
                  
                  
                  
                  
                <th scope="col">Device</th>
                <th scope="col">Status</th>
                <th scope="col">Control</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                  
                  
             <% for (var i = 0; i < devices.length; i++) { %>
      <tr>
        <th scope="row"><%= devices[i].name %></th>
        <% if (devices[i].status === 'on') { %>
          <td><span class="badge bg-success"><%= devices[i].status %></span></td>
          <td><button id="<%=devices[i]._id%> " type="button" class="btn btn-secondary">Turn Off</button></td>
        <% } else { %>
          <td><span class="badge bg-danger"><%= devices[i].status %></span></td>
          <td><button id="<%=devices[i]._id%> " type="button" class="btn btn-secondary">Turn On</button></td>
        <% } %>
      </tr>
    <% } %>
                
                
              </tr>
            </tbody>
          </table>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger">Turn All Off</button>
          <button type="button" class="btn btn-success">Turn All On</button>
        </div>
      </div>
    </div>
  </div>
  



















<script>
$(document).ready(function () {
  
  // Add event listeners to each button
  $('table').on('click', 'button', function () {
    var row = $(this).closest('tr');
    var deviceType = row.closest('.modal').attr('id').replace('Modal', '');
    var deviceId = row.find('button').attr('id');
    var status = row.find('.badge');

    // Send request to server with button ID and status
    $.ajax({
      url: '/devices?type=' + deviceType + '&id=' + deviceId,

      type: 'Post',
      data: { status: status.text().toLowerCase() },
      success: function (response) {
        if ($(this).hasClass('btn-primary')) { // Turn On button clicked
          status.removeClass('bg-danger').addClass('bg-success').text('On');
        } else if ($(this).hasClass('btn-secondary')) { // Turn Off button clicked
          if (status.hasClass('bg-success')) {
            status.removeClass('bg-success').addClass('bg-danger').text('Off');
            $(this).text('Turn On');
          } else {
            status.removeClass('bg-danger').addClass('bg-success').text('On');
            $(this).text('Turn Off');
          }
        }
      },
      error: function () {
        alert('Error updating device status');
      }
    });
  });

  // Add event listener to Turn All Off button
  $('.btn-danger').click(function () {
    var deviceType = $(this).closest('.modal').attr('id').replace('Modal', '');

    // Send request to server to turn all devices off
    $.ajax({
      url: '/Alldevices?type=' + deviceType,

      type: 'Post',
      data: { status: 'off' },
      success: function (response) {
        $('table tbody tr .badge').removeClass('bg-success').addClass('bg-danger').text('Off');
        $('table tbody tr button.btn-secondary').text('Turn On');
      },
      error: function () {
        alert('Error turning all devices of');
      }
    });
  });

  // Add event listener to Turn All On button
  $('.btn-success').click(function () {
    var deviceType = $(this).closest('.modal').attr('id').replace('Modal', '');

    // Send request to server to turn all devices on
    $.ajax({
      url: '/Alldevices?type=' + deviceType,

      type: 'Post',
      data: { status: 'on' },
      success: function (response) {
        $('table tbody tr .badge').removeClass('bg-danger').addClass('bg-success').text('On');
        $('table tbody tr button.btn-secondary').text('Turn Off');
      },
      error: function () {
        alert('Error turning all devices on');
      }
    });
  });
});

$(document).ready(function () {
// Add event listeners to each button
$('table').on('click', 'button', function () {
var row = $(this).closest('tr');
var light = row.find('th').text();
var status = row.find('.badge');

if ($(this).hasClass('btn-primary')) { // Turn On button clicked
  status.removeClass('bg-danger').addClass('bg-success').text('On');
} else if ($(this).hasClass('btn-secondary')) { // Turn Off button clicked
  if (status.hasClass('bg-success')) {
    status.removeClass('bg-success').addClass('bg-danger').text('Off');
    $(this).text('Turn On');
  } else {
    status.removeClass('bg-danger').addClass('bg-success').text('On');
    $(this).text('Turn Off');
  }
}
});

////lights
// Add event listener to Turn All Off button
$('#lightingModal .btn-danger').click(function () {
$('table tbody tr .badge').removeClass('bg-success').addClass('bg-danger').text('Off');
$('table tbody tr button.btn-secondary').text('Turn On');
});

// Add event listener to Turn All On button
$('#lightingModal .btn-success').click(function () {
$('table tbody tr .badge').removeClass('bg-danger').addClass('bg-success').text('On');
$('table tbody tr button.btn-secondary').text('Turn Off');
});


/////curtains
$('#curtainsModal .btn-danger').click(function () {
$('table tbody tr .badge').removeClass('bg-success').addClass('bg-danger').text('Off');
$('table tbody tr button.btn-secondary').text('Turn On');
});

// Add event listener to Turn All On button
$('#curtainsModal .btn-success').click(function () {
$('table tbody tr .badge').removeClass('bg-danger').addClass('bg-success').text('On');
$('table tbody tr button.btn-secondary').text('Turn Off');
});


/////////water//////////////
$('#waterModal .btn-danger').click(function () {
$('table tbody tr .badge').removeClass('bg-success').addClass('bg-danger').text('Off');
$('table tbody tr button.btn-secondary').text('Turn On');
});

// Add event listener to Turn All On button
$('#waterModal .btn-success').click(function () {
$('table tbody tr .badge').removeClass('bg-danger').addClass('bg-success').text('On');
$('table tbody tr button.btn-secondary').text('Turn Off');
});




//////////smart devices

$('#smart-devicesModal .btn-danger').click(function () {
$('table tbody tr .badge').removeClass('bg-success').addClass('bg-danger').text('Off');
$('table tbody tr button.btn-secondary').text('Turn On');
});

// Add event listener to Turn All On button
$('#smart-devicesModal .btn-success').click(function () {
$('table tbody tr .badge').removeClass('bg-danger').addClass('bg-success').text('On');
$('table tbody tr button.btn-secondary').text('Turn Off');
});






});

</script>










              
              


<%-include("./f2.ejs")%>
